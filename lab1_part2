<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Калькулятор</title>
<style>
body {
  font-family: "Segoe UI", sans-serif;
  background-color: #f3f4f6;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}
.calculator {
  background: white;
  border-radius: 20px;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
  padding: 25px 35px;
  width: 380px; 
  text-align: center;
}
h2 { margin-top: 0; color: #333; }
input, select, button {
  width: 100%;
  font-size: 1.1rem;
  margin: 8px 0;
  padding: 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  box-sizing: border-box;
  outline: none;
}
input:focus, select:focus {
  border-color: #2563eb;
  box-shadow: 0 0 0 2px rgba(37,99,235,0.2);
}
button {
  background-color: #2563eb;
  color: white;
  border: none;
  cursor: pointer;
  font-weight: 600;
  transition: background-color 0.2s;
  margin-top: 15px;
}
button:hover { background-color: #1d4ed8; }
.info {
  margin-top: 20px;
  font-size: 0.85rem;
  color: #6b7280;
  border-top: 1px solid #e5e7eb;
  padding-top: 10px;
  line-height: 1.4;
}
.result {
  min-height: 1.5em;
  font-size: 1.4rem;
  font-weight: bold;
  color: #111827;
  margin-top: 20px;
  word-break: break-all;
}
.error {
  color: #dc2626;
  font-size: 1.1rem;
}
</style>
</head>
<body>
<div class="calculator">
  <h2>Калькулятор</h2>

  <input id="num1" type="text" placeholder="Первое число">
  
  <select id="operation">
    <option value="add">+</option>
    <option value="sub">-</option>
    <option value="mul">×</option>
    <option value="div">÷</option>
  </select>
  
  <input id="num2" type="text" placeholder="Второе число">
  
  <button id="calcBtn">Вычислить</button>

  <div class="result" id="result"></div>

  <div class="info">
    <p>Королёв Павел Андреевич</p>
    <p>Курс: 4, Группа: 4</p>
    <p>2025</p>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/decimal.js@10.4.3/decimal.min.js"></script>
<script>
Decimal.set({ precision: 30 });

const MIN = new Decimal("-1000000000000.000000");
const MAX = new Decimal("1000000000000.000000");


function parseInput(value) {
  value = value.trim();
  if (!value) return null;
  
 
  let normalized = value.replace(',', '.');
  

  const formatRegex = /^-?(\d+|\d{1,3}( \d{3})*)(\.\d+)?$/;
  
  if (!formatRegex.test(normalized)) {
    return null;
  }


  const cleanValue = normalized.replace(/ /g, '');
  try { return new Decimal(cleanValue); } catch { return null; }
}


function formatResult(decimalNum) {
  let rounded = decimalNum.toDecimalPlaces(6, Decimal.ROUND_HALF_UP);
  let s = rounded.toFixed(6); 
 
  if (s.indexOf('.') !== -1) {
      s = s.replace(/0+$/, '');
      s = s.replace(/\.$/, '');
  }

 
  let parts = s.split('.');
  parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, " ");
  
  return parts.join('.');
}

document.getElementById("calcBtn").addEventListener("click", () => {
  const input1 = document.getElementById("num1").value;
  const input2 = document.getElementById("num2").value;
  const op = document.getElementById("operation").value;
  const resultEl = document.getElementById("result");

  resultEl.classList.remove("error");

  const num1 = parseInput(input1);
  const num2 = parseInput(input2);

  if (num1 === null || num2 === null) {
    resultEl.classList.add("error");
    resultEl.textContent = "Ошибка ввода (проверьте формат)";
    return;
  }

  let result;
  try {
    switch (op) {
      case "add": result = num1.plus(num2); break;
      case "sub": result = num1.minus(num2); break;
      case "mul": result = num1.times(num2); break;
      case "div":
        if (num2.isZero()) {
          resultEl.classList.add("error");
          resultEl.textContent = "Деление на 0 невозможно";
          return;
        }
        result = num1.dividedBy(num2);
        break;
    }
  } catch (e) {
    resultEl.textContent = "Ошибка вычисления";
    return;
  }

  if (result.lessThan(MIN) || result.greaterThan(MAX)) {
    resultEl.classList.add("error");
    resultEl.textContent = "Выход из диапазона";
    return;
  }

  resultEl.textContent = formatResult(result);
});
</script>
</body>
</html>
